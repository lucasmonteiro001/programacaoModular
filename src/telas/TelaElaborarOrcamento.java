/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package telas;

import java.text.DecimalFormat;
import codigos.Orcamento;
import com.MySQLConnector.MySQLConnector;
import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.text.MaskFormatter;

/**
 *
 * @author f6770459
 */
public class TelaElaborarOrcamento extends javax.swing.JFrame {
    
    /**
     * Declaracao de atributos
     */
    String numeroCPF, nomeCliente, telCliente, nomeTecnico, descricaoServico;
    String validadeOrcamento;
    int matriculaTecnico, idTecnico, idCliente, numHoras, idOrcamento;
    double valHora, valMateriais, valorTotal;
    Date dataValOrcamento;
    
    /**
     * Creates new form TelaElaborarOrcamento
     */
    public TelaElaborarOrcamento() {
        initComponents();
        setLocationRelativeTo(null);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanelElaborarOrcamento = new javax.swing.JPanel();
        labelModuloElaboracaoOrcamento = new javax.swing.JLabel();
        labelOS = new javax.swing.JLabel();
        labelNumOS = new javax.swing.JLabel();
        labelMatrTecnico = new javax.swing.JLabel();
        labelNumMatrTecnico = new javax.swing.JLabel();
        labelNomeTencnico = new javax.swing.JLabel();
        labelCliente = new javax.swing.JLabel();
        labelCPF = new javax.swing.JLabel();
        labelNomeCliente = new javax.swing.JLabel();
        labelTelefone = new javax.swing.JLabel();
        labelNumTelContato = new javax.swing.JLabel();
        labelSolicitacao = new javax.swing.JLabel();
        textSolicitacaoCliente = new javax.swing.JTextField();
        textAndamentoServico = new java.awt.TextArea();
        labelDescricaoOrcamento = new javax.swing.JLabel();
        labelHorasNecessarias = new javax.swing.JLabel();
        textHorasNecessarias = new javax.swing.JTextField();
        labelValorHora = new javax.swing.JLabel();
        textValorHoraTrabalho = new javax.swing.JTextField();
        labelMaterialNecessario = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tableMaterial = new javax.swing.JTable();
        labelMaoDeObra = new javax.swing.JLabel();
        textValorMaoDeObra = new javax.swing.JTextField();
        labelISSQN = new javax.swing.JLabel();
        textValorISSQN = new javax.swing.JTextField();
        labelValMaterial = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        labelTotalOrcamento = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        textValorMaterial = new javax.swing.JTextField();
        textValorTotalOrcamento = new javax.swing.JTextField();
        labelValidadeOrcamento = new javax.swing.JLabel();
        comboBoxDias = new javax.swing.JComboBox<>();
        labelDias = new javax.swing.JLabel();
        buttonGravarOrcamento = new javax.swing.JButton();
        buttonCancelaOrcamento = new javax.swing.JButton();
        buttonCalcular = new javax.swing.JButton();
        buttonRecuperaInfoOS = new javax.swing.JButton();
        buttonSelecionarMaterial = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
        setTitle("Modulo de Elaboracao de Orcamento");

        labelModuloElaboracaoOrcamento.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        labelModuloElaboracaoOrcamento.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        labelModuloElaboracaoOrcamento.setText("Modulo de Elaboracao de Orcamento");
        labelModuloElaboracaoOrcamento.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);

        labelOS.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelOS.setText("Nº da OS:");

        labelNumOS.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelNumOS.setForeground(new java.awt.Color(0, 0, 204));
        labelNumOS.setText(String.valueOf(Orcamento.getNumeroOS()));

        labelMatrTecnico.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelMatrTecnico.setText("Matr. do Tecnico:");

        labelNumMatrTecnico.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelNumMatrTecnico.setForeground(new java.awt.Color(0, 0, 153));

        labelNomeTencnico.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelNomeTencnico.setText("Nome do Tecnico");

        labelCliente.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelCliente.setText("Cliente:");

        labelCPF.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelCPF.setForeground(new java.awt.Color(0, 0, 204));

        labelNomeCliente.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N

        labelTelefone.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelTelefone.setText("Tel. Contato:");

        labelNumTelContato.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelNumTelContato.setForeground(new java.awt.Color(0, 0, 153));

        labelSolicitacao.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelSolicitacao.setText("Solicitacao do Cliente:");

        textSolicitacaoCliente.setEditable(false);
        textSolicitacaoCliente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textSolicitacaoClienteActionPerformed(evt);
            }
        });

        textAndamentoServico.setName(""); // NOI18N
        textAndamentoServico.setText("Descreva aqui o orcamento, custos orçados e seu andamento");

        labelDescricaoOrcamento.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelDescricaoOrcamento.setText("Descricao do Orcamento e Andamento do Servico");

        labelHorasNecessarias.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelHorasNecessarias.setText("Nº Horas Necessarias:");
        labelHorasNecessarias.setToolTipText("Informar o numero de horas necessarias para a execucao do servico");

        textHorasNecessarias.setToolTipText("Informe o numero de horas necessarias para a execucao do servico");
        textHorasNecessarias.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textHorasNecessariasActionPerformed(evt);
            }
        });

        labelValorHora.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelValorHora.setText("Valor da Hora de Trabalho:");
        labelValorHora.setToolTipText("Informar o valor da hora trabalhada");

        textValorHoraTrabalho.setToolTipText("Informar o valor da hora trabalhada.");
        textValorHoraTrabalho.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textValorHoraTrabalhoActionPerformed(evt);
            }
        });

        labelMaterialNecessario.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelMaterialNecessario.setText("Material(ais) Necessario(s) Para a Execucao do Servico:");
        labelMaterialNecessario.setToolTipText("");

        tableMaterial.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        tableMaterial.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null},
                {null, null},
                {null, null},
                {null, null},
                {null, null}
            },
            new String [] {
                "Material / Peca", "Preco"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane1.setViewportView(tableMaterial);

        labelMaoDeObra.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelMaoDeObra.setText("Valor da Mao-de-Obra:");
        labelMaoDeObra.setToolTipText("Retorna o valor total da mao-de-obra.");

        textValorMaoDeObra.setEditable(false);
        textValorMaoDeObra.setToolTipText("Retorna o valor total da mao-de-obra");
        textValorMaoDeObra.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textValorMaoDeObraActionPerformed(evt);
            }
        });

        labelISSQN.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelISSQN.setText("Valor do ISSQN (5%):");
        labelISSQN.setToolTipText("Retorna o valor total do Imposto Sobre Serviços de Qualquer Natureza");

        textValorISSQN.setEditable(false);
        textValorISSQN.setToolTipText("Retorna o valor total do Imposto Sobre Serviços de Qualquer Natureza");
        textValorISSQN.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textValorISSQNActionPerformed(evt);
            }
        });

        labelValMaterial.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelValMaterial.setText("Valor dos Materiais / Peças:");
        labelValMaterial.setToolTipText("Retorna o valor total da mao-de-obra.");

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel1.setText("R$");

        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel2.setText("R$");

        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel3.setText("R$");

        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel4.setText("R$");

        labelTotalOrcamento.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelTotalOrcamento.setText("Valor Total do Orcamento:");
        labelTotalOrcamento.setToolTipText("Retorna o valor total orcado para a execucao do servico");

        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel5.setText("R$");

        textValorMaterial.setToolTipText("Retorna o valor total dos materiais");
        textValorMaterial.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textValorMaterialActionPerformed(evt);
            }
        });

        textValorTotalOrcamento.setEditable(false);
        textValorTotalOrcamento.setToolTipText("Retorna o valor total orcado para a execucao do servico");
        textValorTotalOrcamento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textValorTotalOrcamentoActionPerformed(evt);
            }
        });

        labelValidadeOrcamento.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelValidadeOrcamento.setText("Orcamento Valido Por:");
        labelValidadeOrcamento.setToolTipText("Dias de Validade do Orcamento");

        comboBoxDias.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        comboBoxDias.setForeground(new java.awt.Color(0, 0, 204));
        comboBoxDias.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "30", "60", "90" }));
        comboBoxDias.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                comboBoxDiasActionPerformed(evt);
            }
        });

        labelDias.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        labelDias.setText("Dias");

        buttonGravarOrcamento.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        buttonGravarOrcamento.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons/sim.png"))); // NOI18N
        buttonGravarOrcamento.setText("Gravar");
        buttonGravarOrcamento.setToolTipText("Efetua a gravacao do Orcamento e abre tela para consulta");
        buttonGravarOrcamento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonGravarOrcamentoActionPerformed(evt);
            }
        });

        buttonCancelaOrcamento.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        buttonCancelaOrcamento.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons/nao.png"))); // NOI18N
        buttonCancelaOrcamento.setText("Cancelar");
        buttonCancelaOrcamento.setToolTipText("Nao efetua a gravacao do orcamento e volta para a tela anterior");
        buttonCancelaOrcamento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonCancelaOrcamentoActionPerformed(evt);
            }
        });

        buttonCalcular.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        buttonCalcular.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons/calculadora.png"))); // NOI18N
        buttonCalcular.setText("Orçamento");
        buttonCalcular.setToolTipText("Calcula o valor total do Orçamento");
        buttonCalcular.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonCalcularActionPerformed(evt);
            }
        });

        buttonRecuperaInfoOS.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        buttonRecuperaInfoOS.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons/loading.png"))); // NOI18N
        buttonRecuperaInfoOS.setText("Buscar Info OS");
        buttonRecuperaInfoOS.setToolTipText("Recupar os dados da Ordem de Serviço");
        buttonRecuperaInfoOS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buttonRecuperaInfoOSActionPerformed(evt);
            }
        });

        buttonSelecionarMaterial.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        buttonSelecionarMaterial.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons/selectItens.png"))); // NOI18N
        buttonSelecionarMaterial.setText("Selecionar Materiais");
        buttonSelecionarMaterial.setToolTipText("Selecionar os materiais a serem usados no servico");

        javax.swing.GroupLayout jPanelElaborarOrcamentoLayout = new javax.swing.GroupLayout(jPanelElaborarOrcamento);
        jPanelElaborarOrcamento.setLayout(jPanelElaborarOrcamentoLayout);
        jPanelElaborarOrcamentoLayout.setHorizontalGroup(
            jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanelElaborarOrcamentoLayout.createSequentialGroup()
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                .addComponent(textSolicitacaoCliente)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(buttonRecuperaInfoOS))
                            .addComponent(textAndamentoServico, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(labelMaterialNecessario)
                                    .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                        .addComponent(buttonSelecionarMaterial)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(buttonGravarOrcamento)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(buttonCancelaOrcamento))
                                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 6, Short.MAX_VALUE)
                                .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                            .addComponent(labelMaoDeObra)
                                            .addComponent(labelValMaterial)
                                            .addComponent(labelValorHora)
                                            .addComponent(labelHorasNecessarias))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                            .addComponent(textHorasNecessarias, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                                .addComponent(jLabel2)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(textValorMaoDeObra))
                                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                                .addComponent(jLabel3)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(textValorMaterial, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE))
                                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                                .addComponent(jLabel4)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(textValorHoraTrabalho, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE))))
                                    .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                            .addComponent(labelValidadeOrcamento)
                                            .addComponent(labelISSQN)
                                            .addComponent(labelTotalOrcamento))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                                .addComponent(comboBoxDias, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(labelDias))
                                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                                .addComponent(jLabel5)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(textValorTotalOrcamento))
                                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                                .addComponent(jLabel1)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(textValorISSQN, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                                .addGap(5, 5, 5)
                                .addComponent(buttonCalcular)))
                        .addGap(106, 106, 106))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanelElaborarOrcamentoLayout.createSequentialGroup()
                        .addComponent(labelDescricaoOrcamento)
                        .addGap(524, 524, 524))
                    .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                .addComponent(labelCliente)
                                .addGap(18, 18, 18)
                                .addComponent(labelCPF, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(labelNomeCliente, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                .addComponent(labelOS)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(labelNumOS)
                                .addGap(0, 0, Short.MAX_VALUE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                .addComponent(labelMatrTecnico)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(labelNumMatrTecnico, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(labelNomeTencnico, javax.swing.GroupLayout.PREFERRED_SIZE, 220, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(270, 270, 270))
                            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                                .addComponent(labelTelefone)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(labelNumTelContato, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addGap(477, 477, 477))))))
            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                        .addGap(267, 267, 267)
                        .addComponent(labelModuloElaboracaoOrcamento))
                    .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(labelSolicitacao)))
                .addGap(0, 0, Short.MAX_VALUE))
        );
        jPanelElaborarOrcamentoLayout.setVerticalGroup(
            jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                .addComponent(labelModuloElaboracaoOrcamento, javax.swing.GroupLayout.DEFAULT_SIZE, 44, Short.MAX_VALUE)
                .addGap(18, 18, 18)
                .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(labelOS)
                        .addComponent(labelNumOS)
                        .addComponent(labelMatrTecnico, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(labelNumMatrTecnico, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addComponent(labelNomeTencnico, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(labelNomeCliente, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(labelCPF, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(labelCliente)
                        .addComponent(labelTelefone)
                        .addComponent(labelNumTelContato, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(labelSolicitacao)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(textSolicitacaoCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 46, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(buttonRecuperaInfoOS))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(labelDescricaoOrcamento)
                .addGap(2, 2, 2)
                .addComponent(textAndamentoServico, javax.swing.GroupLayout.PREFERRED_SIZE, 116, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(labelHorasNecessarias)
                    .addComponent(textHorasNecessarias, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(labelMaterialNecessario))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(buttonSelecionarMaterial)
                            .addComponent(buttonGravarOrcamento)
                            .addComponent(buttonCancelaOrcamento))
                        .addGap(64, 64, 64))
                    .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                        .addGap(26, 26, 26)
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel3)
                            .addComponent(labelValMaterial)
                            .addComponent(textValorMaterial, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(textValorMaoDeObra, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(labelMaoDeObra)
                                .addComponent(jLabel2)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel1)
                            .addComponent(labelISSQN)
                            .addComponent(textValorISSQN, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(labelTotalOrcamento)
                            .addComponent(jLabel5)
                            .addComponent(textValorTotalOrcamento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(1, 1, 1)
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(labelValidadeOrcamento)
                            .addComponent(comboBoxDias, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(labelDias))
                        .addContainerGap(60, Short.MAX_VALUE))
                    .addGroup(jPanelElaborarOrcamentoLayout.createSequentialGroup()
                        .addGroup(jPanelElaborarOrcamentoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(labelValorHora)
                            .addComponent(jLabel4)
                            .addComponent(textValorHoraTrabalho, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(buttonCalcular)
                        .addContainerGap())))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanelElaborarOrcamento, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanelElaborarOrcamento, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        setSize(new java.awt.Dimension(926, 601));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void textHorasNecessariasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textHorasNecessariasActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textHorasNecessariasActionPerformed

    private void textValorHoraTrabalhoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textValorHoraTrabalhoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textValorHoraTrabalhoActionPerformed

    private void textValorMaoDeObraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textValorMaoDeObraActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textValorMaoDeObraActionPerformed

    private void textValorISSQNActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textValorISSQNActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textValorISSQNActionPerformed

    private void textValorMaterialActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textValorMaterialActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textValorMaterialActionPerformed

    private void textValorTotalOrcamentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textValorTotalOrcamentoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textValorTotalOrcamentoActionPerformed

    private void comboBoxDiasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_comboBoxDiasActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_comboBoxDiasActionPerformed

    private void buttonCancelaOrcamentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonCancelaOrcamentoActionPerformed
        new TelaOrcamento(0).setVisible(true);
        this.dispose();
    }//GEN-LAST:event_buttonCancelaOrcamentoActionPerformed

    private void buttonCalcularActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonCalcularActionPerformed
        // TODO add your handling code here:
        
        String stValorTotal, stISSQN, stValorMaoDeObra;
        DecimalFormat df = new DecimalFormat("#,##0.00");
        
        numHoras = Integer.parseInt(textHorasNecessarias.getText());
        valHora = Double.parseDouble(textValorHoraTrabalho.getText());
        valMateriais = Double.parseDouble(textValorMaterial.getText());
        
        valorTotal = Orcamento.CalcularOrcamento(numHoras, valHora, valMateriais);
        
        stValorMaoDeObra = String.valueOf(df.format(Orcamento.getValMaoDeObra()));
        stISSQN = String.valueOf(df.format(Orcamento.getValorISS()));
        stValorTotal = String.valueOf(df.format(valorTotal));
        
        textValorHoraTrabalho.setText(String.valueOf(df.format(valHora)));
        textValorMaterial.setText(String.valueOf(df.format(valMateriais)));
        textValorMaoDeObra.setText(stValorMaoDeObra);
        textValorISSQN.setText(stISSQN);
        textValorTotalOrcamento.setText(stValorTotal);
        
        
    }//GEN-LAST:event_buttonCalcularActionPerformed

    private void textSolicitacaoClienteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textSolicitacaoClienteActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textSolicitacaoClienteActionPerformed

    private void buttonRecuperaInfoOSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonRecuperaInfoOSActionPerformed

        try {
            String executeQuerySQL = ("SELECT cliente.idCliente, cliente.cpf, "
                + "cliente.nomeCliente, cliente.telefoneCliente, tecnico.nomeTecnico, "
                + "tecnico.matriculaTecnico, tecnico.idTecnico, ordemservico.descricaoServico "
                + "FROM ordemservico inner join cliente inner join tecnico WHERE "
                + "ordemservico.idOS = " + String.valueOf(Orcamento.getNumeroOS())
                + " and ordemservico.idCliente = cliente.idCliente and "
                + "ordemservico.idTecnico = tecnico.idTecnico");
            PreparedStatement stmt;
  
            stmt = MySQLConnector.conn.prepareStatement(executeQuerySQL);
            ResultSet resultado = stmt.executeQuery(executeQuerySQL);
            
            while (resultado.next()) {                
                numeroCPF = resultado.getString("cliente.cpf");
                nomeCliente = resultado.getString("cliente.nomeCliente");
                telCliente = resultado.getString("cliente.telefoneCliente");
                nomeTecnico = resultado.getString("tecnico.nomeTecnico");
                matriculaTecnico = resultado.getInt("tecnico.matriculaTecnico");
                descricaoServico = resultado.getString("ordemservico.descricaoServico");
                idTecnico = resultado.getInt("tecnico.idTecnico");
                idCliente = resultado.getInt("cliente.idCliente");
            }
            /* long strToLong = Long.parseLong(telCliente);
            
            String sf = String.format("%011l", strToLong);
            telCliente = format("(##)#####-####", sf); 
            */
            telCliente = format("(##)####-####", telCliente);
            labelNumMatrTecnico.setText(String.valueOf(matriculaTecnico));
            labelNomeTencnico.setText(nomeTecnico);
            labelCPF.setText(numeroCPF);
            labelNomeCliente.setText(nomeCliente);
            labelNumTelContato.setText(telCliente);
            textSolicitacaoCliente.setText(descricaoServico);
            
            
        } catch (SQLException ex) {
            Logger.getLogger(TelaElaborarOrcamento.class.getName()).log(Level.SEVERE, null, ex);
        }
                
    }//GEN-LAST:event_buttonRecuperaInfoOSActionPerformed

    private void buttonGravarOrcamentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonGravarOrcamentoActionPerformed
        try {
            String insertTableSQL = "INSERT INTO orcamento"
                    + "(idOS, idTecnico, idCliente, descricaoOrcamento, numHoras,"
                    + " valorHora, valorServico) VALUES"
                    + "(?,?,?,?,?,?,?)";
            PreparedStatement stmt = MySQLConnector.conn.prepareStatement(insertTableSQL);
            stmt.setInt(1, Integer.parseInt(this.labelNumOS.getText()));
            stmt.setInt(2, this.idTecnico);
            stmt.setInt(3, this.idCliente);
            stmt.setString(4, this.textAndamentoServico.getText());
            stmt.setInt(5, Integer.parseInt(this.textHorasNecessarias.getText()));
            stmt.setDouble(6, this.valHora);
            stmt.setDouble(7, this.valorTotal);
            
            stmt.executeUpdate();
            
            String validadeOrcamento = comboBoxDias.getSelectedItem().toString();
            
            String executeQuerySQL = ("SELECT orcamento.idOrcamento "
                    + "DATE_ADD(orcamento.prazoOrcamento, INTERVAL " + validadeOrcamento 
                    + " DAY) AS prazoOrcamento FROM orcamento WHERE idOS =  " 
                    + String.valueOf(Orcamento.getNumeroOS()));
            
            stmt = MySQLConnector.conn.prepareStatement(executeQuerySQL);
            ResultSet resultado = stmt.executeQuery(executeQuerySQL);
            
            SimpleDateFormat formatter = new SimpleDateFormat("yyyy/MM/dd");
            
            while (resultado.next()) {
                validadeOrcamento = resultado.getString("orcamento.prazoOrcamento");
                dataValOrcamento = (Date)formatter.parse(validadeOrcamento);
                idOrcamento = resultado.getInt("orcamento.idOrcamento");   
            }
            
            String mensagem = "Anote o numero do orcamento gerado: " 
                    + String.valueOf(idOrcamento);
            JOptionPane.showMessageDialog(null, mensagem);
            
            String updateTableSQL = ("UPDATE orcamento SET orcamento.prazoOrcamento "
                    + "= ? where idOS = " + String.valueOf(Orcamento.getNumeroOS()));
            stmt = MySQLConnector.conn.prepareStatement(updateTableSQL);
            stmt.setDate(1, new java.sql.Date(dataValOrcamento.getTime()));
            
            
            
            //preparedStatement.setDate(8, this.comboBoxDias.getActionCommand());
            
            // preparedStatement.executeUpdate();
            
        
        } catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_buttonGravarOrcamentoActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(TelaElaborarOrcamento.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(TelaElaborarOrcamento.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(TelaElaborarOrcamento.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TelaElaborarOrcamento.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new TelaElaborarOrcamento().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton buttonCalcular;
    private javax.swing.JButton buttonCancelaOrcamento;
    private javax.swing.JButton buttonGravarOrcamento;
    private javax.swing.JButton buttonRecuperaInfoOS;
    private javax.swing.JButton buttonSelecionarMaterial;
    private javax.swing.JComboBox<String> comboBoxDias;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JPanel jPanelElaborarOrcamento;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel labelCPF;
    private javax.swing.JLabel labelCliente;
    private javax.swing.JLabel labelDescricaoOrcamento;
    private javax.swing.JLabel labelDias;
    private javax.swing.JLabel labelHorasNecessarias;
    private javax.swing.JLabel labelISSQN;
    private javax.swing.JLabel labelMaoDeObra;
    private javax.swing.JLabel labelMaterialNecessario;
    private javax.swing.JLabel labelMatrTecnico;
    private javax.swing.JLabel labelModuloElaboracaoOrcamento;
    private javax.swing.JLabel labelNomeCliente;
    private javax.swing.JLabel labelNomeTencnico;
    private javax.swing.JLabel labelNumMatrTecnico;
    private javax.swing.JLabel labelNumOS;
    private javax.swing.JLabel labelNumTelContato;
    private javax.swing.JLabel labelOS;
    private javax.swing.JLabel labelSolicitacao;
    private javax.swing.JLabel labelTelefone;
    private javax.swing.JLabel labelTotalOrcamento;
    private javax.swing.JLabel labelValMaterial;
    private javax.swing.JLabel labelValidadeOrcamento;
    private javax.swing.JLabel labelValorHora;
    private javax.swing.JTable tableMaterial;
    private java.awt.TextArea textAndamentoServico;
    private javax.swing.JTextField textHorasNecessarias;
    private javax.swing.JTextField textSolicitacaoCliente;
    private javax.swing.JTextField textValorHoraTrabalho;
    private javax.swing.JTextField textValorISSQN;
    private javax.swing.JTextField textValorMaoDeObra;
    private javax.swing.JTextField textValorMaterial;
    private javax.swing.JTextField textValorTotalOrcamento;
    // End of variables declaration//GEN-END:variables

    private static String format(String pattern, Object value) { 
        MaskFormatter mask; 
            try { 
                mask = new MaskFormatter(pattern); 
                mask.setValueContainsLiteralCharacters(false); 
                return mask.valueToString(value); 
            } catch (ParseException e) { 
                throw new RuntimeException(e); 
            } 
    } 

}